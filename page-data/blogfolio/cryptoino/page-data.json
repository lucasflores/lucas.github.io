{"componentChunkName":"component---src-templates-blog-post-js","path":"/blogfolio/cryptoino/","result":{"data":{"markdownRemark":{"html":"<style>\n.image-right{\n  float: right;\n  width: 54%;\n  padding-left:25px;\n}\n\n@media only screen and (max-device-width: 500px) {\n  .image-right{\n    width: 100%;\n    float: fixed;\n    padding-left:0px;\n  }\n}\n.image-left{\n  float: left;\n  width: 54%;\n  padding-right:25px;\n}\n.page-image{\n  position: relative;\n}\n.image-credit-top {\n  position: absolute;\n  top: 0;\n  right: 0;\n  margin: 0 auto;\n  padding: 10px 15px;\n  background-color: rgba(0,0,0,.5);\n  color: #ffffff;\n  text-align: right;\n  z-index: 10;\n  font-size:small;\n  a {\n    color: #ffffff;\n    text-decoration: none;\n  }\n}\n.image-credit {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  margin: 0 auto;\n  padding: 10px 15px;\n  background-color: rgba(0,0,0,.5);\n  color: #ffffff;\n  text-align: right;\n  z-index: 10;\n  font-size:small;\n  a {\n    color: #ffffff;\n    text-decoration: none;\n  }\n}\n.fig-spacing{\n  font-size:small;\n  padding: 8px 15px 15px ;\n}\n.code-div {\n  height: 500px;\n  overflow-y: scroll;\n}\n</style>\n<div class=\"page-image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 925px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAABAAD/8QAFQEBAQAAAAAAAAAAAAAAAAAAAgP/2gAMAwEAAhADEAAAAdmCZC55kj//xAAaEAACAwEBAAAAAAAAAAAAAAAAAQIDERIh/9oACAEBAAEFAqK/HBDociEsfWmn/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/AW1//8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAECAQE/AWR//8QAGRAAAwADAAAAAAAAAAAAAAAAARARABJR/9oACAEBAAY/AqVdsI4//8QAGRABAQEBAQEAAAAAAAAAAAAAAQARQVFx/9oACAEBAAE/IdQ6+FwaSGkfCYiCJOeX/9oADAMBAAIAAwAAABBYz//EABcRAQEBAQAAAAAAAAAAAAAAAAEAMRH/2gAIAQMBAT8QV0y6X//EABcRAQEBAQAAAAAAAAAAAAAAAAERADH/2gAIAQIBAT8Qgse6G//EABwQAQADAAIDAAAAAAAAAAAAAAEAESExQXGh0f/aAAgBAQABPxBMPNHr5GcvE36ZuDcAcTthBb3lwSQ1I9TVlz//2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Hacky Hackin Again: Pennapps XV\" title=\"Hacky Hackin Again: Pennapps XV\" src=\"/static/aee6cd1e59d8c8f428d2efcb9bc40983/0ff56/donuts.jpg\" srcset=\"/static/aee6cd1e59d8c8f428d2efcb9bc40983/d4da3/donuts.jpg 231w,\n/static/aee6cd1e59d8c8f428d2efcb9bc40983/ecde2/donuts.jpg 463w,\n/static/aee6cd1e59d8c8f428d2efcb9bc40983/0ff56/donuts.jpg 925w,\n/static/aee6cd1e59d8c8f428d2efcb9bc40983/8d810/donuts.jpg 1388w,\n/static/aee6cd1e59d8c8f428d2efcb9bc40983/aa991/donuts.jpg 1850w,\n/static/aee6cd1e59d8c8f428d2efcb9bc40983/e1596/donuts.jpg 2048w\" sizes=\"(max-width: 925px) 100vw, 925px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n  <div class=\"image-credit\">image source: <a href=\"https://www.facebook.com/pg/pennapps/photos/\" itemprop=\"citation\">PennApps facebook</a></div><!-- /.image-credit -->\n</div><!-- /.page-image -->\n<blockquote>\n<h3>Our team wanted to incorporate machine learning and neural networks into our project for our own education. We identified a need for lightweight symmetric key exchange in the ever growing Internet of Things (IoT).</h3>\n</blockquote>\n<h1>Introduction</h1>\n<p>This blog post will mostly be entirely self contained, but I do, on occasion, make a call back or two to my first post.\nSo if your feeling pumped about Hackathons you can check that one out here <a href=\"https://lucasflores.com/blogfolio/eyeHUD/\">First Hackathon: Pennapps XIV</a>.</p>\n<p>In an attempt to capture lightning in a bottle, our team of physicists set out to reign in prizes and free swag left and right.\nBut as you can imagine recreating the magic of my first Hackathon was not so straight forward.\nFor one, arguably our biggest hurdle happened at the very beginning.\nWhich had to do with this small matter of not having come up with hack to work on (<em>suspense grows</em>). </p>\n<h1>The Competition</h1>\n<p>This year our team was composed of reigning 3rd place finishers Sebastian, Rob and I along with hackathon newcomer and fellow physicist, Arjun.\nSo I actually had come into the event with a few potential ideas that we could work on.\nOne was what would have basically been an accelerometer+Arduino based device that you could attach to you washer/dryer with the idea being that you could monitor the cycle at some coarse grain level based on some signal processing of the accelerometer data.\nWhich I thought would have been a pretty interesting dive into some data driven analysis.\nThis came from me having to use ancient washing machines in the basements of apartment buildings while finding myself living in the 3rd/4th floor (with no elevator).\nHowever not everyone on the team was super pumped about my dumb-to-smart washing machine idea  ☹️ .\nBut I'm not salty about this at all.\nAnd also to be fair finding a washer/dryer which we could use to collect data nearby the event venue was not really straight forward on such short notice.\nWe luckily all did end up converging on a set of ideas we would like to work with just out of our own interest.\nThese ideas being in the \"whats-so-hot-right-now\" machine learning/neural net realm.\nSo that was a good step forward.\nWe were then trying to fit these ideas into doing something pertaining to a 'side' competition, i.e. a more focused challenge put on by one of the Hackathon's  sponsor companies, often having to use their API and some pseudo-data they provide (things like \"Best Finance Hack\" sponsored by Capitol One).\nWe did this partially for selfish reasons, if our hack qualifies for multiple categories/competitions we increase the probability getting cool prizes.\nAnd partially just because we thought it would help us come up with an idea.\nUltimately these challenges were just too narrowly defined and we were pretty stubborn about only working on something were weren't all genuinely interested in.\nSo the brainstorming continued, taking up our entire first evening of the hackathon, which would definitely feed into a time crunch later.\nWith little to show for the first day of the competition we all headed home that evening hoping that inspiration would strike before the morning. </p>\n<p>Luckily inspiration struck our boy Arjun, who came in hot the next morning with a banger of an idea.\nI can't speak for everyone but I immediately thought it was awesome.\nAnd we pretty quickly decided to go all in on this hack. </p>\n<p>Here's the pitch:</p>\n<blockquote>\n<p>Embedded devices in household or everyday items do not have much processing power or memory; nevertheless, there is a great need to secure these devices from attackers.\nState-of-the-art exchange schemes such as Diffie-Hellman asymmetric exchange are arithmetically expensive, a fact that prohibits their implementation on constrained-memory systems that sometimes use integer widths as small as 8 bits.\nThis observation led us to the idea of Tree Parity Machine symmetric key exchange, an idea pioneered by physicists in the early 2000's (<a href=\"https://arxiv.org/abs/cond-mat/0208453\">paper here</a>), and we tested their feasibility on an Arduino system.</p>\n</blockquote>\n<p>And thus came the hack \"<em>Cryptoino</em>\", the portmanteau of Cryptography and Arduino and not the fermionic superpartner to the Crypto boson (dumb particle physics joke pls keep reading im sry). </p>\n<h1>The Theory</h1>\n<p>For those who don't like to have a cryptography paper thrust upon them as required reading in the middle of some random blog post I'll try to distill the main points here.\nUsing the neural net diagram below we will walk through what Kanto and Kinser proved in their paper. </p>\n<div class=\"image-right\">\n<div class=\"page-image\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 925px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 58.44155844155845%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAMABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAECAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAHdcAsEH//EABUQAQEAAAAAAAAAAAAAAAAAACBB/9oACAEBAAEFAof/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAACAgMAAAAAAAAAAAAAAAAAEQFBITGR/9oACAEBAAE/IZzI0hlWdGf/2gAMAwEAAgADAAAAELAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARIVExkf/aAAgBAQABPxB+1Ckz2DThy5TsrRf1Ew3B2Dqf/9k='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Hacky Hackin Again: Pennapps XV\" title=\"Hacky Hackin Again: Pennapps XV\" src=\"/static/afff6330a7e3b648c97d9cbc698ad353/0ff56/Tree_Parity_Machine.jpg\" srcset=\"/static/afff6330a7e3b648c97d9cbc698ad353/d4da3/Tree_Parity_Machine.jpg 231w,\n/static/afff6330a7e3b648c97d9cbc698ad353/ecde2/Tree_Parity_Machine.jpg 463w,\n/static/afff6330a7e3b648c97d9cbc698ad353/0ff56/Tree_Parity_Machine.jpg 925w,\n/static/afff6330a7e3b648c97d9cbc698ad353/64b22/Tree_Parity_Machine.jpg 1199w\" sizes=\"(max-width: 925px) 100vw, 925px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n  <figcaption class=\"fig-spacing\"><i>A Tree Parity Machine nueral network. Two TPMs of identical topology are needed for the key exchange.</i></figcaption>\n  <div class=\"image-credit-top\">image source: <a href=\"https://\" itemprop=\"citation\">Wikipedia</a></div><!-- /.image-credit -->\n</div><!-- /.page-image -->\n</div><!-- /.page-image -->\n<p>For starters the thing in the figure on the right is called a \"Tree Parity Machine\" (TPM), which is a special type of multi-layered feedforward neural network.\nIn this scheme we have two TPMs of identical structure, tree <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>A</mi></mrow><annotation encoding=\"application/x-tex\">A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\">A</span></span></span></span> and tree <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>B</mi></mrow><annotation encoding=\"application/x-tex\">B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.05017em;\">B</span></span></span></span>.\nThe same set of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">K</span></span></span></span> random input vectors <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mover accent=\"true\"><mi>x</mi><mo>⃗</mo></mover><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\vec{x}_i</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.864em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.20772em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span> of size <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> are fed into each TPM.\nThen <em>different</em> sets of <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>K</mi></mrow><annotation encoding=\"application/x-tex\">K</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.07153em;\">K</span></span></span></span> random weight vectors <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow><mrow><mi>A</mi><mi mathvariant=\"normal\">/</mi><mi>B</mi></mrow></msubsup></mrow><annotation encoding=\"application/x-tex\">\\vec{w}_{i,j}^{A/B}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4577719999999998em;vertical-align:-0.4129719999999999em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.15216em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span><span class=\"mord mtight\">/</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4129719999999999em;\"><span></span></span></span></span></span></span></span></span></span> of size <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.68333em;vertical-align:0em;\"></span><span class=\"mord mathdefault\" style=\"margin-right:0.10903em;\">N</span></span></span></span> are applied on each TPM.\nThe vectors can take on the following values:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow><mrow><mi>A</mi><mi mathvariant=\"normal\">/</mi><mi>B</mi></mrow></msubsup><mo>∈</mo><mo stretchy=\"false\">{</mo><mo>−</mo><mi>L</mi><mo separator=\"true\">,</mo><mo>−</mo><mi>L</mi><mo>+</mo><mn>1</mn><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><mi>L</mi><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mi>L</mi><mo stretchy=\"false\">}</mo><mo separator=\"true\">;</mo></mrow><annotation encoding=\"application/x-tex\">\\vec{w}_{i,j}^{A/B} \\in \\{-L,-L+1,...,L-1,L\\};</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.4577719999999998em;vertical-align:-0.412972em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.15216em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4231360000000004em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span><span class=\"mord mtight\">/</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.412972em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">−</span><span class=\"mord mathdefault\">L</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">−</span><span class=\"mord mathdefault\">L</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8777699999999999em;vertical-align:-0.19444em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mord\">.</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">L</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord mathdefault\">L</span><span class=\"mclose\">}</span><span class=\"mpunct\">;</span></span></span></span></span>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo separator=\"true\">,</mo><mi>j</mi></mrow></msub><mo>∈</mo><mo stretchy=\"false\">{</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>+</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">x_{i,j}\\in \\{-1,+1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8252079999999999em;vertical-align:-0.286108em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.311664em;\"><span style=\"top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span><span class=\"mpunct mtight\">,</span><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05724em;\">j</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.286108em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mord\">+</span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span></span>\n<p>The input values are then weighted according to the Hebbian rule:</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mi>i</mi><mi>A</mi></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mo>+</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><msubsup><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mi>i</mi><mi>A</mi></msubsup><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>+</mo><msub><mover accent=\"true\"><mi>x</mi><mo>⃗</mo></mover><mi>i</mi></msub></mrow><annotation encoding=\"application/x-tex\">\\vec{w}_{i}^{A}(t+1)=\\vec{w}^{A}_{i}(t)+\\vec{x}_{i}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.15216em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.15216em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathdefault\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.864em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.20772em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span>\n<p>I'll spend a little more time here since this is essentially the main logical crux of the entire process.\nSo this Hebbian rule, or Hebbian learning, is something that comes out of neuroscientific theory and is often summarized as \"cells that fire together wire together.\"\nSo a Hebbian rule is a rule that increases (updates) weights (influence) of the network if the neurons of the network are activating together.\nThe sign of the inner product of the weight vector and input vector is then taken after the weights have been updated.</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msubsup><mi>σ</mi><mi>i</mi><mi>A</mi></msubsup><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msubsup><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mi>i</mi><mi>A</mi></msubsup><mo>⋅</mo><msub><mover accent=\"true\"><mi>x</mi><mo>⃗</mo></mover><mi>i</mi></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">;</mo><mspace width=\"2.8452755905511813em\"/><msubsup><mi>σ</mi><mi>i</mi><mi>B</mi></msubsup><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msubsup><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mi>i</mi><mi>B</mi></msubsup><mo>⋅</mo><msub><mover accent=\"true\"><mi>x</mi><mo>⃗</mo></mover><mi>i</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma_{i}^{A}=sign(\\vec{w}_{i}^{A} \\cdot \\vec{x}_{i});  \\hspace{1cm}  \\sigma_{i}^{B}=sign(\\vec{w}_{i}^{B} \\cdot \\vec{x}_{i})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.138331em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathdefault\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.15216em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.20772em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:2.8452755905511813em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413309999999999em;vertical-align:-0.25em;\"></span><span class=\"mord mathdefault\">s</span><span class=\"mord mathdefault\">i</span><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathdefault\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.15216em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\">x</span></span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.20772em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.31166399999999994em;\"><span style=\"top:-2.5500000000000003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></span>\n<p>The product of these sigmas is taken resulting in a final output values <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>τ</mi><mi>A</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\tau^A</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span></span></span></span></span></span></span> and <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>τ</mi><mi>B</mi></msup></mrow><annotation encoding=\"application/x-tex\">\\tau^B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8413309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8413309999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span></span></span></span></span></span></span>, which can take on the numerical value of +1 or -1.</p>\n<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>τ</mi><mi>A</mi></msup><mo>=</mo><msubsup><mi>σ</mi><mn>1</mn><mi>A</mi></msubsup><msubsup><mi>σ</mi><mn>2</mn><mi>A</mi></msubsup><msubsup><mi>σ</mi><mn>3</mn><mi>A</mi></msubsup><mo separator=\"true\">;</mo><mspace width=\"2.8452755905511813em\"/><msup><mi>τ</mi><mi>B</mi></msup><mo>=</mo><msubsup><mi>σ</mi><mn>1</mn><mi>B</mi></msubsup><msubsup><mi>σ</mi><mn>2</mn><mi>B</mi></msubsup><msubsup><mi>σ</mi><mn>3</mn><mi>B</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">\\tau^{A}=\\sigma_{1}^{A}\\sigma_{2}^{A}\\sigma_{3}^{A}; \\hspace{1cm} \\tau^{B}=\\sigma_{1}^{B}\\sigma_{2}^{B}\\sigma_{3}^B</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8913309999999999em;vertical-align:0em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138331em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\">A</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.16666666666666666em;\"></span><span class=\"mspace\" style=\"margin-right:2.8452755905511813em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.1132em;\">τ</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2777777777777778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.138331em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathdefault\" style=\"margin-right:0.03588em;\">σ</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913309999999999em;\"><span style=\"top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathdefault mtight\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span>\n<p>The training, and therefore synchronization, are achieved by comparing the outputs between the two trees, only updating the weights of both trees if the outputs are <em>not</em> the same.\nRandom input vectors are continually generated and input into the TPMs and weights updated (or not) according to the scheme that was laid out.\nThe beautiful thing that happens next is that the weights themselves, in each tree, will synchronize.\nFor the actual proof you will have to check out the <a href=\"https://arxiv.org/abs/cond-mat/0208453\">paper</a>.\nBut you can believe me, I'm trustworthy, probably. </p>\n<div class=\"image-right\">\n<video width=\"100%\" height=\"auto\" autoplay loop muted playsinline controls src=\"/video.webm\"></video>\n<figcaption class=\"fig-spacing\"><i>gif of the two TPMs syncronizing as they train each other. The colored lines represent different weights as the training progresses. The  </i></figcaption>\n</div><!-- /.page-image -->\n<p>We now have a secure method of symmetric key exchange.\nAll the two parties involved have to do is agree upon a neural net topology (within the allowed TPM structure) and follow the prescription laid out previously to be able to securely communicate with each other.\nA great visualization that I made during the competition (judges love visuals) is the <code class=\"language-text\">gif</code> (converted to a <code class=\"language-text\">.webm</code>) on the right where the neural-net weights are depicted as the colored lines that extend from the input neurons to the inner layer.\nThe numerical weights are mapped to some color spectrum and so as the weights change the colors change.\nThe first two networks are the two TPMs (A and B) and the third network is just the difference between the weights of network A and B.\nIn this way it is easy to see when the networks synchronize as the third network will become a single bright green (green <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>→</mo></mrow><annotation encoding=\"application/x-tex\">\\to</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.36687em;vertical-align:0em;\"></span><span class=\"mrel\">→</span></span></span></span> 0.0 in this mapping).\nIn real time the network synchronizes very quickly but I have slowed it down here just to show the adventure it takes.\nFeel free to skip to the end to see it synchronize.\nNow that we are done with that bit of book learnin' we can get back to the hack. </p>\n<h1>The Hack</h1>\n<div class=\"image-right\">\n<picture>\n  <source type=\"image/webp\" srcset=\"./images/cryptoino/device.webp\">\n  <source type=\"image/png\" srcset=\"./images/cryptoino/device.jpg\">\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 370px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 133.33333333333331%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAbABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEBQP/xAAWAQEBAQAAAAAAAAAAAAAAAAADAgD/2gAMAwEAAhADEAAAAZ1pWE1yM0J3x9CGQ7hp/8QAGxAAAgMBAQEAAAAAAAAAAAAAAQIDERIAMTL/2gAIAQEAAQUCe8iklBjpl3GsAVEWlJBYlTFnn9i+a7//xAAaEQACAgMAAAAAAAAAAAAAAAAAAQIRECFB/9oACAEDAQE/Aa5hQ2Uj/8QAGREAAgMBAAAAAAAAAAAAAAAAABEBAiEQ/9oACAECAQE/AXnJtgz/xAAgEAABBAEEAwAAAAAAAAAAAAABAAIRIQMSIjFBIHGR/9oACAEBAAY/AsTDTQE0sMlcj6txMDhax3Vro+004p2hQDc+P//EAB0QAQACAgIDAAAAAAAAAAAAAAEAETFBIWFRcaH/2gAIAQEAAT8hbqvszNzUgZgwY4Gpg7blhG0jwIIU9kdyK3D+2I5ldKemDKApxEXP/9oADAMBAAIAAwAAABBD8AP/xAAZEQEBAQADAAAAAAAAAAAAAAABABEhMWH/2gAIAQMBAT8QQODW5u6t5X//xAAYEQEAAwEAAAAAAAAAAAAAAAAAESExUf/aAAgBAgEBPxC0lMifX//EAB8QAQACAQQDAQAAAAAAAAAAAAEAESExUWGRQXGBsf/aAAgBAQABPxArgCrdOhU425ldh4Aq4TqN9EU159xFYkSjkFHFOZQtwRUNdNF/PcGLgFFW0N5jcKONLctO8eki8albuvcfE2yh0QkZCmUairw42h0BX2f/2Q=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Hacky Hackin Again: Pennapps XV\" title=\"Hacky Hackin Again: Pennapps XV\" src=\"/static/497999a3cabbaba488dc3f73cb3cf52f/f4308/device.jpg\" srcset=\"/static/497999a3cabbaba488dc3f73cb3cf52f/d4da3/device.jpg 231w,\n/static/497999a3cabbaba488dc3f73cb3cf52f/f4308/device.jpg 370w\" sizes=\"(max-width: 370px) 100vw, 370px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n</picture>\n<figcaption class=\"fig-spacing\"><i>Our two Arduinos doing some Tree Parity Machine symmetric key exchange :)</i></figcaption>\n</div><!-- /.page-image -->\n<p>I was familiar with Arduinos (a popular programmable microcontroller) coming into this Hackathon just because I had purchased one at some point with the idea of doing some fun side projects.\nI believe my original weird idea was to make a remote drawing machine/robot thing.\nLike if you had one of these devices I could, from my phone, draw a little picture and it would in 'real' time draw my drawing on a piece of paper thousands of miles away via your device.\nThings like this exist of course, but I thought, and still think, I could do this easily for super cheap.\nAnd it seemed fun.\nThat being said I never finished this project, but maybe I'll resurrect it someday, and maybe attach it to a drone or something.\nBut anyway.\nSo I after giving the TPM key exchange paper a quick scan and seeing how straight forward the logic should be to write up in some code it seemed simple enough to hook up two of these bad boys together to have a nice proof of concept.\nNow the flagship Arduino is the Arduino UNO but it is a little big (relatively) and in the spirit of our hack, bringing lightweight, secure, and fast encryption to small IoT devices, we opted for the smallest of the Arduino line we could source from the hardware library of the competition.\nThese ended up being two Arduino MKR1000's.\nThe two Arduino MKR1000's were attached to your standard bread board as you can see in the figure to the right.\nThen we needed to make sure we knew what each pin inputs/outputs on the Arduinos were doing, i.e. which were digital, analog, and power.\nAfter this short look up and a bit of a think we hooked up the wires and <em>whbam</em> the hardware part of the hack was essentially done.\nOn the software side of things we began with a <code class=\"language-text\">Python</code> implementation of a tree parity machine simulator.\nSo in this we just wanted to get a proof of concept coded up on our computers so that we had code we new worked before moving to the full implementation on the Arduinos.\nThe code for this simulator was actually pretty simple so I just pasted the whole script below.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> sys\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">tpmUpdate</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">,</span>sigma<span class=\"token punctuation\">,</span>L<span class=\"token punctuation\">,</span>tau<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> \n    sigma <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>tau<span class=\"token operator\">*</span>sigma<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token operator\">/</span><span class=\"token number\">2</span> <span class=\"token comment\"># hacky AND of {-1,1} wrt tau</span>\n    x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>sigma<span class=\"token operator\">*</span>np<span class=\"token punctuation\">.</span>transpose<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># don't change hidden nodes with </span>\n                                            <span class=\"token comment\"># output not equal to tau</span>\n    w <span class=\"token operator\">+=</span> x <span class=\"token comment\"># Hebbian update rule</span>\n    w<span class=\"token punctuation\">[</span>w <span class=\"token operator\">&lt;</span> <span class=\"token operator\">-</span>L<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span>L <span class=\"token comment\"># reflective random walk boundaries</span>\n    w<span class=\"token punctuation\">[</span>w <span class=\"token operator\">></span> L<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> L\n    <span class=\"token keyword\">return</span> w\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">tpmEval</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>w<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># w - weights array</span>\n                  <span class=\"token comment\"># x - random input matrix</span>\n    sigma <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>sign<span class=\"token punctuation\">(</span>np<span class=\"token punctuation\">.</span><span class=\"token builtin\">sum</span><span class=\"token punctuation\">(</span>x<span class=\"token operator\">*</span>w<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># sum of each row: axis = 1</span>\n    sigma<span class=\"token punctuation\">[</span>sigma <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token comment\"># conditional replacement</span>\n    tau <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>prod<span class=\"token punctuation\">(</span>sigma<span class=\"token punctuation\">)</span> <span class=\"token comment\"># hidden layer bits combined</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>sigma<span class=\"token punctuation\">,</span>tau<span class=\"token punctuation\">)</span>\n    \n<span class=\"token keyword\">def</span> <span class=\"token function\">sync</span><span class=\"token punctuation\">(</span>w1<span class=\"token punctuation\">,</span>w2<span class=\"token punctuation\">,</span>L<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># synchronize two TPMs with initial weights w1, w2</span>\n    <span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> w1<span class=\"token punctuation\">.</span>shape\n    binSet <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    j <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token keyword\">while</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">not</span> np<span class=\"token punctuation\">.</span>array_equal<span class=\"token punctuation\">(</span>w1<span class=\"token punctuation\">,</span>w2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n        x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>choice<span class=\"token punctuation\">(</span>binSet<span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># random input matrix x_{ij} </span>\n        <span class=\"token punctuation\">(</span>sigma1<span class=\"token punctuation\">,</span>tau1<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> tpmEval<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>w1<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">(</span>sigma2<span class=\"token punctuation\">,</span>tau2<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> tpmEval<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>w2<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>tau1 <span class=\"token operator\">==</span> tau2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            j <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n            tpmUpdate<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>w1<span class=\"token punctuation\">,</span>sigma1<span class=\"token punctuation\">,</span>L<span class=\"token punctuation\">,</span>tau1<span class=\"token punctuation\">)</span>\n            tpmUpdate<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>w2<span class=\"token punctuation\">,</span>sigma2<span class=\"token punctuation\">,</span>L<span class=\"token punctuation\">,</span>tau2<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">,</span>w1<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">initialize</span><span class=\"token punctuation\">(</span>L<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># initializes a weight matrix with vals {-L,...,L}</span>\n                       <span class=\"token comment\"># and dimensions (k,n)</span>\n    w <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>random<span class=\"token punctuation\">.</span>random_integers<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span>L<span class=\"token punctuation\">,</span>L<span class=\"token punctuation\">,</span>size<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> w\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># computes synchronization time of two Tree Parity Machines</span>\n            <span class=\"token comment\"># with 2L+1 weight values, k hidden nodes, and n inputs to each</span>\n            <span class=\"token comment\"># hidden node</span>\n    L <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    k <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    n <span class=\"token operator\">=</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>sys<span class=\"token punctuation\">.</span>argv<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n    w1 <span class=\"token operator\">=</span> initialize<span class=\"token punctuation\">(</span>L<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span>\n    w2 <span class=\"token operator\">=</span> initialize<span class=\"token punctuation\">(</span>L<span class=\"token punctuation\">,</span>k<span class=\"token punctuation\">,</span>n<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">(</span>steps<span class=\"token punctuation\">,</span>useful<span class=\"token punctuation\">,</span>keys<span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span> sync<span class=\"token punctuation\">(</span>w1<span class=\"token punctuation\">,</span>w2<span class=\"token punctuation\">,</span>L<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">print</span> <span class=\"token string\">\"Synced in \"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>steps<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\" steps, \"</span><span class=\"token operator\">+</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span>useful<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token string\">\" useful.\"</span>\n\nmain<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<br>\n<p>Alright so \"you're basically done\" you might say, \"just slap that python script on to the Arduinos and go collect your prizes\" you tell me.\nWell hold your little ponies buster, not so fast.\nFor one, Arduinos don't like <code class=\"language-text\">Python</code> so we will first need to convert this to <code class=\"language-text\">.C</code> and then do some cross checking with the <code class=\"language-text\">Python</code> code.\nThis wasn't too bad as far as I can remember, but I might need to check with a teammate on the veracity of that statement.\nI think the headache really was in the next two steps.\nAfter the <code class=\"language-text\">.C</code> conversion the code then needed to be split up in a way such that we have a <code class=\"language-text\">master</code> and <code class=\"language-text\">slave</code> device, i.e. we only want one device generating new random input vectors.\nThen transitioning, where necessary, the <code class=\"language-text\">.C</code> code into calls and functions actually contained in the Arduino ARM libraries such that our algorithm will actually run on these little devices.\nThis coupled with understanding the real time serial communication, memory buffers, and just really base level computation managing was surprisingly challenging (for the time frame).\nAnd I think I can safely say the latter step is stuff that none of us had anticipated having to deal with.\nThat being said it is often the most surprising things that are the most interesting, and it really was interesting having to figure all this stuff out.\nHowever it being interesting had no real dampening effect on how frustrating it was to get it all to work.\nWith that we ultimately got the proof-of-concept like 90% working the night before the expo.\nNow I know your thinking, \"what in the flying fuck does 90% working mean?\"\nWell I'll let Sebastian tell you:\n<br></p>\n<blockquote>\n<h2>\"I am now remembering something about the communication protocol (I2C I believe) not working exactly like we expected. I remember we spent a long time trying to send simple bit sequences and failing.\"</h2>\n</blockquote>\n<br>\n<p>And I should probably say that I am writing this post quite a while after the event so all of our memories are a little fuzzy.\nWhat this meant was that none of us got any sleep the night before the expo.\nWe were all working on this bug for what had to be at least six hours right up until it was time to set up our table at the expo.\nAnd honestly I was pretty proud of our systematic approach of figuring out what it <em>couldn't</em> be.\nAnd well by the time we had to stop working on this we were honestly all convinced that there was an issue with the Arduino ARM libraries as we had done everything we could to leave no stone unturned.\nAnd I am pretty sure every stone was turned a number of times.\nBut I'll be honest we (well at least me) didn't follow up on this after the competition.\nBut I'm also fairly confident that if we had just used the flagship Arduino UNO with its well vetted libraries we would have never had to endure this headache.\nI think the Arduino MKR1000 being some smaller more obscure microcontroller was really our problem.\nSo ultimately we couldn't get the full proof of concept working 100%, and this was a little crushing at the time.\nBut anyway we had to make due with what we had and start pitching our hack.\nAnd what  we did have working was a 'half-simulation', the nice little colorful <code class=\"language-text\">gif</code> shown previously, and a pretty darn good pitch.\nNow you're probably wondering what a 'half-simulation' is, and well it is pretty much what is sounds like.\nIt is something that came out of our debugging marathon as we knew our simulated TPC worked and so we developed a mash up of the simulation laptop based code and the pure Arduino code in order to pin point where our bug was.\ni.e. we had a single Arduino running the <code class=\"language-text\">slave</code> code hooked up to the laptop, which was running the <code class=\"language-text\">master</code> code, and that had always worked.\nSo this what was set up at the expo an were on a loop performing the super cool tree parity machine key exchange like gangbusters.\nSo all was not lost and we did have something pretty cool to present come judgement day.\nWe also had a cool logo you can see below which I made :).</p>\n<div class=\"image-right\">\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 925px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 74.8917748917749%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABD0lEQVQ4y61UXU+DQBDk1/ITeSNR0j6ogVZTqlyx7VGIb6ARkO+RvYSGmjtqEzaZHMvOTm65ObS6rtG27SwgLY0e5grS0pqmEUnXdVIQSVUbg4K0LgRviTFfKkhR9d8gTTOUZSl2RmuSJPhOUxRFgSzLz7umoJx6hrgQJFJwChFFH3iyV/DfD7i7t6DrOlbrF+z8PY48gMd2eHi0sdm+CT4PQvXIpzDqSRG2rx6Szy8sFkuYpok8/0HQN+4PRwGP+bCdZ/GORJUjU2Gcu64Lx3GktUHgb648lKqqYFkWDMNAHMdSJ0weiozMOQdjDNesNWmb8Uo1wnCqKmtd9aGsccqn/xr5VpwFZ7/Lc/9tfgEqIpas3GL12QAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"Hacky Hackin Again: Pennapps XV\" title=\"Hacky Hackin Again: Pennapps XV\" src=\"/static/7fb54836b1178ffeee3bb28834fea8c0/2a50c/cryptoinologo.002.png\" srcset=\"/static/7fb54836b1178ffeee3bb28834fea8c0/6e622/cryptoinologo.002.png 231w,\n/static/7fb54836b1178ffeee3bb28834fea8c0/71ce0/cryptoinologo.002.png 463w,\n/static/7fb54836b1178ffeee3bb28834fea8c0/2a50c/cryptoinologo.002.png 925w,\n/static/7fb54836b1178ffeee3bb28834fea8c0/2bef9/cryptoinologo.002.png 1024w\" sizes=\"(max-width: 925px) 100vw, 925px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n    </span>\n<figcaption class=\"fig-spacing\"><i>I like making logos for these things. Hopefully you can accept that the key is a \"P\" here.</i></figcaption>\n</div><!-- /.page-image -->\nWell judgement day was nigh.\nThe first round was a little rough at the start as we were immediately coming off of the mild failure of being so close to having our hack 100% working.\nThis in addition to the standard roughness of refining our individual pitches. \nI think we had enough practice before the judge eventually came along though. \nBut even so there seemed to be some resistance to our hack, something that felt very familiar from the last hackathon we did. \nIt was this sense that the judges were more looking for some hack that had a clean web design instead of something that actually did something interesting.\nStill not salty.\nDespite this resistance we did make it to the second round (yay!).\nThis round differed from the first not only in it having fewer teams (obviously) but also in the number of judges that judge you (i.e. more than 1). \nAnd it suffices to say that the resistance I mentioned earlier reared its head once more. \nAnd unfortunately the judging pool appeared to be a bit more homogeneous this this time, i.e. no outlier that was in our corner. \nAnd with that, despite some excellent pitching and the coolest neural net synchronization `gif` you've ever seen, we did not make it into the top 10 to go pitch in the final round ☹️  .\nNo prizes this time around and no live video feed of our final presentation. \nBut I did think we built something really cool.\nAnd like they say, it's the journey, not the destination.\nBut I mean some prizes at the destination wouldn't have upset us.","timeToRead":13,"frontmatter":{"title":"Hacky Hackin Again: Pennapps XV","date":"2017-01-24","tags":["Hackathon","Neural Net","Cryptography"]}}},"pageContext":{"slug":"/blogfolio/cryptoino/"}},"staticQueryHashes":[]}